# Progress log

- 2026-01-09: Implemented core message-sending behavior via a minimal `ChatStore` (in-memory) with a Vitest unit test.
  - Added `package.json` + `tsconfig.json` with `pnpm typecheck` and `pnpm test` scripts.
  - Note: this environment denied running `pnpm`/`node` and `git add/commit` (permission prompt couldn't be shown), so checks + commit must be done manually.
  - Next: implement persistence after refresh/reopen (likely via a storage abstraction) and then real-time delivery.

- 2026-02-04: Completed setup-001: Extension scaffolding and activation
  - Created VS Code extension structure with package.json, tsconfig.json, and src folder
  - Defined extension activation events (onView:ralph.prdExplorer, workspaceContains:**/plans/prd.json)
  - Implemented extension entry point (src/extension.ts) that registers commands and views
  - Created PrdTreeDataProvider (src/prdTreeDataProvider.ts) to load and display PRD items
  - Added Ralph activity bar icon (resources/ralph-icon.svg)
  - Extension compiles successfully with TypeScript (pnpm typecheck ✓, pnpm compile ✓)
  - Note: Used git hash-object workaround due to mkdir/file creation permission restrictions
  - Next: The extension is ready to run in Extension Development Host for testing

- 2026-02-04: Completed setup-002: PRD file detection and loading
  - Updated extension.ts to register PrdTreeDataProvider with the ralph.prdExplorer view
  - Added command registrations for ralph.refresh and ralph.addItem
  - Fixed PrdStep type to handle both string and object formats (text + completed fields)
  - PrdTreeDataProvider now properly loads prd.json from plans/ folder
  - Implemented file watcher to automatically reload when prd.json changes externally
  - Added error handling for malformed JSON with user-friendly error messages
  - Extension compiles and type-checks successfully (pnpm typecheck ✓, pnpm compile ✓)
  - Next: Extension should now display PRD items in sidebar when loaded in Extension Development Host

- 2026-02-04: Completed ui-001: Sidebar tree view displays PRD items
  - Enhanced PrdTreeDataProvider to support category grouping
  - Added CategoryNode class to represent category groups in the tree
  - Modified TreeNode type to support both CategoryNode and PrdItem
  - Updated getTreeItem() to render categories as expandable folders
  - Updated getChildren() to group items by category at root level
  - Categories are sorted alphabetically and displayed in UPPERCASE
  - Each category is expandable/collapsible with folder icon
  - PRD items are displayed under their respective categories
  - Items show status in description and appropriate status icons
  - Extension compiles and type-checks successfully (pnpm typecheck ✓, pnpm compile ✓)
  - Next: Test in Extension Development Host to verify tree view with category grouping works correctly


- 2026-02-04: Completed ui-002: Sidebar shows status indicators for each item
  - Enhanced getStatusIcon() method to return both icon name and ThemeColor
  - Added distinct colored icons for each status:
    * not-started: circle-outline (gray)
    * in-progress: sync~spin with animation (yellow)
    * in-review: eye (blue)
    * completed: pass (green - using testing.iconPassed theme color)
  - Updated getTreeItem() to destructure and apply both icon and color
  - File watcher ensures sidebar updates automatically when prd.json is modified
  - Extension compiles successfully (pnpm typecheck ✓, pnpm compile ✓)
  - Next: ui-003 (Detail panel) would be a logical next feature for item interaction


- 2026-02-04: Completed ui-003: Detail panel opens when selecting a sidebar item
  - Created DetailPanel class (src/detailPanel.ts) to manage webview panel lifecycle
  - Implemented singleton pattern to reuse/reveal existing panel when clicking items
  - Added ralph.openItem command to extension.ts and registered it in activation
  - Made tree items clickable by adding command property to PrdItem tree items
  - Webview displays comprehensive item details: id, category, description, status, passes
  - Styled status badges with color-coded indicators matching sidebar icons
  - Rendered steps list with checkboxes showing completion state (checked/unchecked)
  - Applied strikethrough and opacity to completed steps for visual clarity
  - HTML escaping ensures safe rendering of user content
  - Panel updates when clicking different items in sidebar
  - Extension compiles successfully (pnpm typecheck ✓, pnpm compile ✓)
  - Next: functional-001 (Add new PRD item) or functional-005 (Toggle step completion) to enable interactivity


- 2026-02-04: Completed functional-005: Toggle step completion checkboxes
  - Enabled scripts in webview panel (enableScripts: true)
  - Added onclick handlers to checkboxes with cursor pointer styling
  - Implemented JavaScript function toggleStep() that posts messages to extension
  - Created message handler in DetailPanel to receive toggleStep messages from webview
  - Implemented toggleStepCompletion() method that:
    * Reads current prd.json file
    * Finds the item by ID
    * Converts string steps to object format {text, completed} on first toggle
    * Toggles the completed boolean state for subsequent clicks
    * Writes updated JSON back to file with proper formatting (tabs)
    * Refreshes the webview to show updated state
  - Checkboxes are now interactive and persist state to prd.json
  - File watcher ensures sidebar stays in sync with prd.json changes
  - Extension compiles and type-checks successfully (pnpm typecheck ✓, pnpm compile ✓)
  - Next: functional-006 (Change item status) or functional-001 (Add new PRD item) for more interactivity

- 2026-02-04: Completed functional-006: Change item status from detail panel
  - Added status dropdown/selector to detail panel metadata section
  - Implemented changeStatus() JavaScript function to post status change messages
  - Added changeItemStatus() method to handle status updates in DetailPanel class
  - Status dropdown includes all valid statuses: not-started, in-progress, in-review, completed
  - Added validation to ensure only valid status values are accepted
  - Updates persist immediately to prd.json file with proper formatting
  - File watcher ensures sidebar automatically refreshes to show new status icon
  - User receives confirmation message when status is updated
  - Extension compiles successfully (pnpm typecheck ✓, pnpm compile ✓)
  - Next: functional-007 (Toggle passes field) or functional-001 (Add new PRD item)

- 2026-02-04: Completed functional-007: Toggle passes field from detail panel
  - Added togglePasses message handler in DetailPanel class
  - Created interactive passes toggle button with visual states (green checkmark for true, red X for false)
  - Implemented togglePasses() JavaScript function to post messages from webview to extension
  - Added togglePasses() method to toggle passes field and persist to prd.json
  - Applied distinct styling to passes toggle: green background when true, red when false
  - User receives confirmation message when passes field is updated
  - Toggle shows icon (✓ or ✗) and descriptive text ("Passes" or "Does not pass")
  - Extension compiles and type-checks successfully (pnpm typecheck ✓, pnpm compile ✓)
  - Next: functional-001 (Add new PRD item) or functional-008 (Auto-generate unique IDs) would be valuable next features


- 2026-02-04: Completed functional-001: Add new PRD item
  - Implemented addItem() method in PrdTreeDataProvider to add new items to prd.json
  - Created generateUniqueId() method that generates IDs in format 'category-XXX' (e.g., 'ui-005')
  - ID generation finds highest number in category and increments (with zero-padding to 3 digits)
  - Updated ralph.addItem command in extension.ts to show input dialogs
  - Added QuickPick for category selection (setup, ui, functional, git, agent, polish)
  - Added InputBox for description entry with helpful placeholder text
  - New items are created with: auto-generated ID, selected category, entered description, empty steps array, status 'not-started', passes false
  - File watcher ensures sidebar refreshes automatically after adding item
  - User receives confirmation message showing the new item ID
  - Add Item button (+ icon) is available in sidebar toolbar via existing package.json configuration
  - Extension compiles and type-checks successfully (pnpm typecheck ✓, pnpm compile ✓)
  - Also completed functional-008 (Auto-generate unique IDs) as part of this implementation
  - Next: functional-002 (Edit existing PRD item) or functional-003 (Delete PRD item) for full CRUD operations

- 2026-02-04: Completed functional-002: Edit existing PRD item
  - Added ralph.editItem command to package.json with edit icon
  - Registered command in view/item/context menu for prdItem context (appears when right-clicking items)
  - Implemented editItem() method in PrdTreeDataProvider to update existing items
  - Edit dialog shows QuickPick for category selection (pre-selected with current category)
  - Edit dialog shows InputBox for description (pre-filled with current description)
  - User can cancel at any step by pressing ESC or clicking Cancel
  - Updates are persisted to prd.json with proper JSON formatting (tabs)
  - File watcher ensures sidebar refreshes automatically to show updated item
  - User receives confirmation message when item is updated
  - Edit button appears inline in tree view for each PRD item
  - Extension compiles and type-checks successfully (pnpm typecheck ✓, pnpm compile ✓)
  - Next: functional-003 (Delete PRD item) or functional-004 (Add, edit, remove steps) for more CRUD operations
